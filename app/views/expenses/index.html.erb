<!-- app/views/expenses/index.html.erb -->

<!-- Header -->
<%= render "shared/title", title: "Expenses" %>

<!-- Month navigation -->
<%= render "shared/month_nav", current_date: @current_date %>

<!-- Category Filter -->
<div class="flex gap-2 mb-6 overflow-x-auto">
  <%= link_to "All",
        expenses_path(month: @current_date.month, year: @current_date.year),
        class: @current_category.nil? ? "shrink-0 px-3 py-1 rounded-full text-sm font-medium whitespace-nowrap bg-black text-white" : "shrink-0 px-3 py-1 rounded-full text-sm font-medium whitespace-nowrap border border-gray-300 text-gray-600 hover:text-black" %>
  <% @categories.each do |cat| %>
    <%= link_to cat.name,
          expenses_path(month: @current_date.month, year: @current_date.year, category: cat.id),
          class: @current_category == cat ? "shrink-0 px-3 py-1 rounded-full text-sm font-medium whitespace-nowrap bg-black text-white" : "shrink-0 px-3 py-1 rounded-full text-sm font-medium whitespace-nowrap border border-gray-300 text-gray-600 hover:text-black" %>
  <% end %>
</div>

<!-- Quick Add Form -->
<%= render "quick_add_form", expense: @expense %>

<div class="rounded-lg bg-white shadow-sm">
  <div class="border-b border-gray-300 px-6 py-4 font-medium">
    <%= @current_category ? "#{@current_category.name} Expenses" : "All Expenses" %>
  </div>

  <% if @expenses.any? %>
    <ul class="divide-y">
      <% @expenses.each do |e| %>
        <li class="flex items-center justify-between px-6 py-3 border-b border-gray-100">
          <div>
            <div class="font-medium"><%= e.category.name %></div>
            <div class="text-sm text-gray-500">
              <%= e.date.strftime("%b %d, %Y") %>
              <%= e.note.present? ? "â€” #{e.note}" : "" %>
            </div>
          </div>

          <div class="font-semibold">
            <%= number_to_eur(e.amount) %>
          </div>
        </li>
      <% end %>
    </ul>
  <% else %>
    <div class="px-6 py-8 text-center text-sm text-gray-500">
      No expenses yet.
    </div>
  <% end %>
</div>
